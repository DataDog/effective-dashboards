{"title":"Kubernetes Capacity Planning","description":"## Kubernetes Capacity Planning\n\nUse this Dashboard to understand the requested CPU/Memory for pods and what is really used\n\nSome resources:\n\n- [Datadog Infra > Kubernetes](https://docs.datadoghq.com/containers/kubernetes/#overview)\n- [Kubernetes patterns: capacity planning](https://www.cncf.io/blog/2019/10/08/kubernetes-patterns-capacity-planning/)\n- [Kubernetes scaling](https://medium.com/pareture/kubernetes-scaling-capacity-and-resource-planning-in-complex-clusters-97a6105b43a4)\n- [Setting up Vertical Pod Autoscaler](https://www.kubecost.com/kubernetes-autoscaling/kubernetes-vpa/)","widgets":[{"id":443466849361936,"definition":{"type":"note","content":"# Kubernetes Capacity Planning\n\nThis dashboard aims to provide the relevant information for Kubernetes administrators and users to identify if the CPU and Mem requests are properly configured and not generating unnecessary waste.","background_color":"gray","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":0,"y":0,"width":5,"height":3}},{"id":3857869053162142,"definition":{"type":"image","url":"/static/images/integration_dashboard/kubernetes_hero_2.jpeg","sizing":"cover","has_background":true,"has_border":true,"vertical_align":"center","horizontal_align":"center"},"layout":{"x":5,"y":0,"width":7,"height":3}},{"id":986801580339488,"definition":{"title":"CPU Utilization","type":"group","background_color":"purple","show_title":true,"layout_type":"ordered","widgets":[{"id":3899377194392834,"definition":{"title":"CPU by cluster","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"requests","cell_display_mode":"bar","limit":{"count":500,"order":"desc"},"formula":"query1"},{"alias":"limits","cell_display_mode":"bar","formula":"query2"},{"alias":"usage","cell_display_mode":"bar","formula":"query7"},{"alias":"num cores","cell_display_mode":"bar","formula":"query3"},{"alias":"cpu idle","cell_display_mode":"bar","formula":"query4"},{"alias":"cpu system","cell_display_mode":"bar","formula":"query5"},{"alias":"cpu user","cell_display_mode":"bar","formula":"query6"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.cpu.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query7","aggregator":"avg"},{"query":"sum:system.cpu.num_cores{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query3","aggregator":"avg"},{"query":"avg:system.cpu.idle{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query4","aggregator":"avg"},{"query":"avg:system.cpu.system{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"avg:system.cpu.user{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query6","aggregator":"avg"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":0,"width":12,"height":3}},{"id":7314515826517936,"definition":{"title":"CPU by host","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"requests","cell_display_mode":"bar","limit":{"count":50,"order":"desc"},"formula":"query1"},{"alias":"limits","cell_display_mode":"bar","formula":"query2"},{"alias":"usage","cell_display_mode":"bar","formula":"query7"},{"alias":"num cores","cell_display_mode":"bar","formula":"query3"},{"alias":"cpu idle","cell_display_mode":"bar","formula":"query4"},{"alias":"cpu system","cell_display_mode":"bar","formula":"query5"},{"alias":"cpu user","cell_display_mode":"bar","formula":"query6"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.cpu.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query7","aggregator":"avg"},{"query":"sum:system.cpu.num_cores{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query3","aggregator":"avg"},{"query":"avg:system.cpu.idle{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query4","aggregator":"avg"},{"query":"avg:system.cpu.system{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"avg:system.cpu.user{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query6","aggregator":"avg"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":3,"width":12,"height":4}},{"id":3525521108453928,"definition":{"title":"Quota CPU by namespace","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"formula":"query1","cell_display_mode":"bar","alias":"requests"},{"formula":"query2","cell_display_mode":"bar","alias":"limits"},{"formula":"query3","cell_display_mode":"bar","alias":"quota request"},{"formula":"query4","cell_display_mode":"bar","limit":{"count":50,"order":"desc"},"alias":"quota request used"},{"formula":"query5","cell_display_mode":"bar","alias":"quota limit"},{"formula":"query6","cell_display_mode":"bar","alias":"quota limit used"},{"formula":"query7","cell_display_mode":"bar","alias":"Max real use"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.cpu.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes_state.resourcequota.requests.cpu.limit{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query3","aggregator":"avg"},{"query":"sum:kubernetes_state.resourcequota.requests.cpu.used{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query4","aggregator":"avg"},{"query":"sum:kubernetes_state.resourcequota.limits.cpu.limit{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes_state.resourcequota.limits.cpu.used{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query6","aggregator":"avg"},{"query":"sum:kubernetes.cpu.user.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query7","aggregator":"max"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":7,"width":12,"height":3}}]},"layout":{"x":0,"y":3,"width":12,"height":11}},{"id":7221989593948132,"definition":{"title":"Memory","type":"group","background_color":"purple","show_title":true,"layout_type":"ordered","widgets":[{"id":7573198214876406,"definition":{"title":"Memory by cluster","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"requests","cell_display_mode":"bar","limit":{"count":500,"order":"desc"},"formula":"query1"},{"alias":"limits","cell_display_mode":"bar","formula":"query2"},{"alias":"usage","cell_display_mode":"bar","formula":"query6"},{"alias":"total","cell_display_mode":"bar","formula":"query3"},{"alias":"Free","cell_display_mode":"bar","formula":"query4"},{"alias":"Used","cell_display_mode":"bar","formula":"query5"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.memory.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.memory.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query6","aggregator":"avg"},{"query":"sum:system.mem.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query3","aggregator":"avg"},{"query":"sum:system.mem.free{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query4","aggregator":"avg"},{"query":"sum:system.mem.used{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query5","aggregator":"avg"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":0,"width":12,"height":3}},{"id":7180277133072254,"definition":{"title":"Memory by host","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"requests","cell_display_mode":"bar","limit":{"count":50,"order":"desc"},"formula":"query1"},{"alias":"limits","cell_display_mode":"bar","formula":"query2"},{"alias":"usage","cell_display_mode":"bar","formula":"query6"},{"alias":"total","cell_display_mode":"bar","formula":"query3"},{"alias":"Free","cell_display_mode":"bar","formula":"query4"},{"alias":"Used","cell_display_mode":"bar","formula":"query5"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.memory.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.memory.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query6","aggregator":"avg"},{"query":"sum:system.mem.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query3","aggregator":"avg"},{"query":"avg:system.mem.free{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query4","aggregator":"avg"},{"query":"avg:system.mem.used{$scope,$env,$kube_namespace,$kube_cluster_name} by {env,kube_cluster_name,host}","data_source":"metrics","name":"query5","aggregator":"avg"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":3,"width":12,"height":3}},{"id":3221201963210650,"definition":{"title":"Quota memory by namespace","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"formula":"query1","cell_display_mode":"bar","alias":"requests"},{"formula":"query2","cell_display_mode":"bar","alias":"limits"},{"formula":"query3","cell_display_mode":"bar","alias":"quota request"},{"formula":"query4","cell_display_mode":"bar","limit":{"count":50,"order":"desc"},"alias":"quota request used"},{"formula":"query5","cell_display_mode":"bar","alias":"quota limit"},{"formula":"query6","cell_display_mode":"bar","alias":"quota limit used"},{"formula":"query7","cell_display_mode":"bar","alias":"Max real use"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.memory.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.memory.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes_state.resourcequota.requests.memory.limit{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query3","aggregator":"avg"},{"query":"sum:kubernetes_state.resourcequota.requests.memory.used{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query4","aggregator":"avg"},{"query":"sum:kubernetes_state.resourcequota.limits.memory.limit{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes_state.resourcequota.limits.memory.used{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query6","aggregator":"avg"},{"query":"sum:kubernetes.memory.rss{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_namespace}","data_source":"metrics","name":"query7","aggregator":"max"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":6,"width":12,"height":3}}]},"layout":{"x":0,"y":14,"width":12,"height":10}},{"id":989980698397624,"definition":{"title":"Capacity Review","type":"group","background_color":"vivid_green","show_title":true,"layout_type":"ordered","widgets":[{"id":7328840637400146,"definition":{"type":"note","content":"## Requests and Limits\n\nRequests define the minimum amount of resources that containers need.\n\nFor instance, if you think that your app requires at least 256MB of memory to operate, this is the request value. The application can use more than 256MB, but Kubernetes guarantees a minimum of 256MB to the container.\n\nLimits define the max amount of resources that the container can consume.\n\n### Overprovisioned Pods\n\nIf the utilization vs request is low, it means that some pods have a resource request higher than their nominal utilization and should be resized. This will help Kubernetes allocate pods more properly.\n","background_color":"gray","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":0,"y":0,"width":7,"height":4}},{"id":898849511779978,"definition":{"title":"CPU and Mem by cluster","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"CPU Core \"Wasted\"","conditional_formats":[{"palette":"black_on_light_green","comparator":"<","value":0},{"palette":"white_on_yellow","comparator":">=","value":40},{"palette":"black_on_light_yellow","comparator":">=","value":0}],"limit":{"count":500,"order":"desc"},"formula":"query1 - query7 / 1000000000"},{"alias":"MEM  \"Wasted\"","conditional_formats":[{"palette":"black_on_light_green","comparator":"<","value":0},{"palette":"white_on_yellow","comparator":">=","value":50000000000},{"palette":"black_on_light_yellow","comparator":">=","value":0}],"formula":"query5 - query8"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query7","aggregator":"avg"},{"query":"sum:kubernetes.memory.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query8","aggregator":"avg"}]}],"has_search_bar":"auto"},"layout":{"x":7,"y":0,"width":5,"height":4}},{"id":7714425948675458,"definition":{"title":"CPU and Mem by cluster","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"CPU requests","cell_display_mode":"number","limit":{"count":500,"order":"desc"},"formula":"query1"},{"alias":"CPU limits","cell_display_mode":"number","formula":"query2"},{"alias":"CPU usage","cell_display_mode":"number","formula":"query7"},{"alias":"MEM requests","formula":"query5"},{"alias":"MEM limits","formula":"query6"},{"alias":"MEM usage","formula":"query8"},{"alias":"CPU Cores","formula":"query3"},{"alias":"CPU Idle","formula":"query4"},{"alias":"Mem Total","formula":"query9"},{"alias":"Mem Free","formula":"query10"},{"alias":"% CPU requests","conditional_formats":[{"palette":"white_on_red","comparator":"<","value":60}],"formula":"query7 / (query1 * 1000000000) * 100"},{"alias":"% CPU limits","conditional_formats":[{"palette":"white_on_yellow","comparator":">","value":90}],"formula":"query7 / (query2 * 1000000000) * 100"},{"alias":"% MEM requests","conditional_formats":[{"palette":"white_on_red","comparator":"<","value":60}],"formula":"query8 / query5 * 100"},{"alias":"% MEM limits","conditional_formats":[{"palette":"white_on_yellow","comparator":">","value":90}],"formula":"query8 / query6 * 100"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.cpu.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query7","aggregator":"avg"},{"query":"sum:kubernetes.memory.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes.memory.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query6","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query8","aggregator":"avg"},{"query":"sum:system.cpu.num_cores{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query3","aggregator":"avg"},{"query":"avg:system.cpu.idle{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query4","aggregator":"avg"},{"query":"sum:system.mem.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query9","aggregator":"avg"},{"query":"sum:system.mem.free{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env}","data_source":"metrics","name":"query10","aggregator":"avg"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":4,"width":12,"height":5}},{"id":2615286290931034,"definition":{"title":"CPU and Mem by Kubernetes Objects","title_size":"16","title_align":"left","type":"query_table","requests":[{"formulas":[{"alias":"CPU requests","cell_display_mode":"number","limit":{"count":500,"order":"desc"},"formula":"query1"},{"alias":"CPU limits","cell_display_mode":"number","formula":"query2"},{"alias":"CPU usage","cell_display_mode":"number","formula":"query7"},{"alias":"MEM requests","formula":"query5"},{"alias":"MEM limits","formula":"query6"},{"alias":"MEM usage","formula":"query8"},{"alias":"% CPU requests","conditional_formats":[{"palette":"white_on_red","comparator":"<","value":60}],"formula":"query7 / (query1 * 1000000000) * 100"},{"alias":"% CPU limits","conditional_formats":[{"palette":"white_on_yellow","comparator":">","value":90}],"formula":"query7 / (query2 * 1000000000) * 100"},{"alias":"% MEM requests","conditional_formats":[{"palette":"white_on_red","comparator":"<","value":60}],"formula":"query8 / query5 * 100"},{"alias":"% MEM limits","conditional_formats":[{"palette":"white_on_yellow","comparator":">","value":90}],"formula":"query8 / query6 * 100"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env,kube_deployment,kube_daemon_set,kube_stateful_set}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.cpu.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env,kube_deployment,kube_daemon_set,kube_stateful_set}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env,kube_deployment,kube_daemon_set,kube_stateful_set}","data_source":"metrics","name":"query7","aggregator":"avg"},{"query":"sum:kubernetes.memory.requests{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env,kube_deployment,kube_daemon_set,kube_stateful_set}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes.memory.limits{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env,kube_deployment,kube_daemon_set,kube_stateful_set}","data_source":"metrics","name":"query6","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$scope,$env,$kube_namespace,$kube_cluster_name} by {kube_cluster_name,env,kube_deployment,kube_daemon_set,kube_stateful_set}","data_source":"metrics","name":"query8","aggregator":"avg"}]}],"has_search_bar":"auto"},"layout":{"x":0,"y":9,"width":12,"height":5}},{"id":7625466328402444,"definition":{"type":"note","content":"## Quick focus on deployments and daemonsets\n\nx avis\n```\nCPU usage / CPU requests * 100\n```\ny axis\n```\nMemory usage / Memory requests * 100\n```\nsize\n```\nCPU requests\n```\n\nHow to read:\n- The bigger the size the more CPU is requested for the deployment\n- Bottom-left: low usage of memory and cpu vs requested","background_color":"gray","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":0,"y":14,"width":4,"height":8}},{"id":8554674612774330,"definition":{"title":"Overprovisioned Deployments","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"formula":"query1","dimension":"radius"},{"formula":"query8 / query5 * 100","dimension":"y"},{"formula":"query7 / (query1 * 1000000000) * 100","dimension":"x"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_deployment}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_deployment}","data_source":"metrics","name":"query8","aggregator":"avg"},{"query":"sum:kubernetes.memory.requests{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_deployment}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_deployment}","data_source":"metrics","name":"query7","aggregator":"avg"}]}},"xaxis":{"min":"0","max":"200"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":4,"y":14,"width":8,"height":4}},{"id":3436652130619012,"definition":{"title":"Overprovisioned Daemonset","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"formula":"query1","dimension":"radius"},{"formula":"query8 / query5 * 100","dimension":"y"},{"formula":"query7 / (query1 * 1000000000) * 100","dimension":"x"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_daemon_set}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_daemon_set}","data_source":"metrics","name":"query8","aggregator":"avg"},{"query":"sum:kubernetes.memory.requests{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_daemon_set}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_daemon_set}","data_source":"metrics","name":"query7","aggregator":"avg"}]}},"xaxis":{"min":"0","max":"200"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":4,"y":18,"width":8,"height":4}},{"id":1312586441327138,"definition":{"title":"Underprovisioned Deployments","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"formula":"query1","dimension":"radius"},{"formula":"query8 / query5 * 100","dimension":"y"},{"formula":"query7 / (query1 * 1000000000) * 100","dimension":"x"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.limits{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_deployment}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_deployment}.rollup(max)","data_source":"metrics","name":"query8","aggregator":"max"},{"query":"sum:kubernetes.memory.limits{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_deployment}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_deployment}.rollup(max)","data_source":"metrics","name":"query7","aggregator":"max"}]}},"xaxis":{"include_zero":true,"scale":"linear","min":"auto","max":"auto"},"yaxis":{"include_zero":true,"scale":"linear","min":"auto","max":"auto"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":0,"y":22,"width":6,"height":4}},{"id":7159347358907438,"definition":{"title":"Underprovisioned Daemonsets","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"formula":"query1","dimension":"radius"},{"formula":"query8 / query5 * 100","dimension":"y"},{"formula":"query7 / (query1 * 1000000000) * 100","dimension":"x"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.limits{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_daemon_set}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_daemon_set}.rollup(max)","data_source":"metrics","name":"query8","aggregator":"max"},{"query":"sum:kubernetes.memory.limits{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_daemon_set}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env,kube_daemon_set}.rollup(max)","data_source":"metrics","name":"query7","aggregator":"max"}]}},"xaxis":{"include_zero":true,"scale":"linear","min":"auto","max":"auto"},"yaxis":{"include_zero":true,"scale":"linear","min":"auto","max":"auto"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":22,"width":6,"height":4}},{"id":4232629226293364,"definition":{"title":"Overprovisioned Pods in Cluster","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"formula":"query1","dimension":"radius"},{"formula":"query8 / query5 * 100","dimension":"y"},{"formula":"query7 / (query1 * 1000000000) * 100","dimension":"x"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env}","data_source":"metrics","name":"query1","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env}","data_source":"metrics","name":"query8","aggregator":"avg"},{"query":"sum:kubernetes.memory.requests{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env}","data_source":"metrics","name":"query5","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$env,$kube_namespace,$kube_cluster_name,$scope} by {kube_cluster_name,env}","data_source":"metrics","name":"query7","aggregator":"avg"}]}},"xaxis":{"min":"0","max":"200"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["env"]},"layout":{"x":0,"y":26,"width":12,"height":4}}]},"layout":{"x":0,"y":24,"width":12,"height":31}},{"id":2312273949470430,"definition":{"title":"Capacity Review - CPU","type":"group","background_color":"vivid_green","show_title":true,"layout_type":"ordered","widgets":[{"id":4423666796306342,"definition":{"type":"note","content":"## Overprovisioned Pods\n\nThe heatmaps (below) identify through time if the CPU usage is getting closer to the CPU request. The y axis represents the \n```\nCPU usage / CPU requests * 100\n```\n\n*How to read: The darker the color the more kubernetes objects are in this range of % CPU usage vs CPU requests*","background_color":"gray","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":1378396733554370,"definition":{"type":"note","content":"The scatter plots below represent on average the CPU usage vs the CPU request. The x axis represents thee `CPU requests` and the Y axis represents the\n```\nCPU usage / CPU requests * 100\n```\n\nThe way to read the graph and where to focus on:\n- Bottom-right: high CPU request with actual low CPU usage\n- Bottom-left: low/avg CPU request with actual low CPU usage\n","background_color":"gray","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":7222149659450098,"definition":{"title":"Overprovisioned Deployments","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.cpu.usage.total{kube_deployment:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_deployment} / (sum:kubernetes.cpu.requests{kube_deployment:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_deployment} * 1000000000) * 100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":3,"width":6,"height":4}},{"id":7118080303599968,"definition":{"title":"Overprovisioned Deployments","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / (query2 * 1000000000) * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{kube_deployment:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_deployment,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{kube_deployment:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_deployment,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"min":"0"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":3,"width":6,"height":4}},{"id":6529774174829012,"definition":{"title":"Overprovisioned Daemonset","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.cpu.usage.total{kube_daemon_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_daemon_set} / (sum:kubernetes.cpu.requests{kube_daemon_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_daemon_set} * 1000000000) * 100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":7,"width":6,"height":4}},{"id":2466083133896066,"definition":{"title":"Overprovisioned Daemonset","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / (query2 * 1000000000) * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{kube_daemon_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_daemon_set,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{kube_daemon_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_daemon_set,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"min":"0"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":7,"width":6,"height":4}},{"id":2316944512819738,"definition":{"title":"Overprovisioned Statefulset","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.cpu.usage.total{kube_stateful_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_stateful_set} / (sum:kubernetes.cpu.requests{kube_stateful_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_stateful_set} * 1000000000) * 100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":11,"width":6,"height":4}},{"id":7298285564647162,"definition":{"title":"Overprovisioned Statefulset","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / (query2 * 1000000000) * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{kube_stateful_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_stateful_set,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{kube_stateful_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_stateful_set,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"min":"0"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":11,"width":6,"height":4}},{"id":7527511310379556,"definition":{"title":"Overprovisioned Replicaset","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.cpu.usage.total{kube_replica_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_replica_set} / (sum:kubernetes.cpu.requests{kube_replica_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_replica_set} * 1000000000) * 100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":15,"width":6,"height":4}},{"id":4956455129611560,"definition":{"title":"Overprovisioned Replicaset","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / (query2 * 1000000000) * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{kube_replica_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_replica_set,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{kube_replica_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_replica_set,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"min":"0"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":15,"width":6,"height":4}},{"id":5680890688256886,"definition":{"title":"Overprovisioned Pods","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.cpu.usage.total{$kube_namespace,$kube_cluster_name,$env,$scope} by {pod_name} / (sum:kubernetes.cpu.requests{$kube_namespace,$kube_cluster_name,$env,$scope} by {pod_name} * 1000000000) * 100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":19,"width":6,"height":4}},{"id":7039596238831870,"definition":{"title":"Overprovisioned Pods","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / (query2 * 1000000000) * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.cpu.requests{$kube_namespace,$kube_cluster_name,$env,$scope} by {pod_name,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.cpu.usage.total{$kube_namespace,$kube_cluster_name,$env,$scope} by {pod_name,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"include_zero":true,"scale":"linear","min":"auto","max":"auto"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":19,"width":6,"height":4}}]},"layout":{"x":0,"y":55,"width":12,"height":24,"is_column_break":true}},{"id":2936000658117726,"definition":{"title":"Capacity Review - Memory","type":"group","background_color":"vivid_green","show_title":true,"layout_type":"ordered","widgets":[{"id":2188095730737968,"definition":{"type":"note","content":"## Overprovisioned Pods\n\nThe heatmaps (below) identify through time if the Memory usage is getting closer to the Memory request. The y axis represents the \n```\nMemory usage / Memory requests * 100\n```\n\n*How to read: The darker the color the more kubernetes objects are in this range of % Memory usage vs Memory requests*","background_color":"gray","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":0,"y":0,"width":6,"height":3}},{"id":6929792699387230,"definition":{"type":"note","content":"The scatter plots below represent on average the Memory usage vs the Memory request. The x axis represents thee `Memory requests` and the Y axis represents the\n```\nMemory usage / Memory requests * 100\n```\n\nThe way to read the graph and where to focus on:\n- Bottom-right: high Memory request with actual low Memory usage\n- Bottom-left: low/avg Memory request with actual low Memory usage\n","background_color":"gray","font_size":"14","text_align":"left","vertical_align":"top","show_tick":false,"tick_pos":"50%","tick_edge":"left","has_padding":true},"layout":{"x":6,"y":0,"width":6,"height":3}},{"id":4324832153651694,"definition":{"title":"Overprovisioned Deployments","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.memory.usage{kube_deployment:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_deployment}/sum:kubernetes.memory.requests{kube_deployment:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_deployment}*100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":3,"width":6,"height":4}},{"id":5214745745205540,"definition":{"title":"Overprovisioned Deployments","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / query2 * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.memory.requests{kube_deployment:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_deployment,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{kube_deployment:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_deployment,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"min":"0"},"yaxis":{"min":"0","max":"100"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":3,"width":6,"height":4}},{"id":2258887243446868,"definition":{"title":"Overprovisioned Daemonset","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.memory.usage{kube_daemon_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_daemon_set}/sum:kubernetes.memory.requests{kube_daemon_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_daemon_set}*100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":7,"width":6,"height":4}},{"id":5237194730002230,"definition":{"title":"Overprovisioned Daemonset","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / query2 * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.memory.requests{kube_daemon_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_daemon_set,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{kube_daemon_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_daemon_set,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"min":"0"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":7,"width":6,"height":4}},{"id":344623497153294,"definition":{"title":"Overprovisioned Statefulset","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.cpu.usage.total{kube_stateful_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_stateful_set}/sum:kubernetes.memory.requests{kube_stateful_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_stateful_set}*100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":11,"width":6,"height":4}},{"id":6118361778644500,"definition":{"title":"Overprovisioned Statefulset","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / query2 * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.memory.requests{kube_stateful_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_stateful_set,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{kube_stateful_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_stateful_set,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"min":"0"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_deployment"]},"layout":{"x":6,"y":11,"width":6,"height":4}},{"id":23637952945538,"definition":{"title":"Overprovisioned Replicaset","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.memory.usage{kube_replica_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_replica_set}/sum:kubernetes.memory.requests{kube_replica_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_replica_set}*100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":15,"width":6,"height":4}},{"id":7775606387220348,"definition":{"title":"Overprovisioned Replicaset","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / query2 * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.memory.requests{kube_replica_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_replica_set,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{kube_replica_set:*,$kube_namespace,$kube_cluster_name,$env,$scope} by {kube_replica_set,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"min":"0"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":15,"width":6,"height":4}},{"id":6338333826598052,"definition":{"title":"Overprovisioned Pods","title_size":"16","title_align":"left","show_legend":false,"type":"heatmap","yaxis":{"min":"0","max":"200"},"requests":[{"q":"sum:kubernetes.memory.usage{$kube_namespace,$kube_cluster_name,$env,$scope} by {pod_name}/sum:kubernetes.memory.requests{$kube_namespace,$kube_cluster_name,$env,$scope} by {pod_name}*100","style":{"palette":"dog_classic"}}]},"layout":{"x":0,"y":19,"width":6,"height":4}},{"id":585478333514986,"definition":{"title":"Overprovisioned Pods","title_size":"16","title_align":"left","type":"scatterplot","requests":{"table":{"formulas":[{"alias":"","dimension":"x","formula":"query2"},{"formula":"query1 / query2 * 100","dimension":"y"}],"response_format":"scalar","queries":[{"query":"sum:kubernetes.memory.requests{$kube_namespace,$kube_cluster_name,$env,$scope} by {pod_name,kube_cluster_name}","data_source":"metrics","name":"query2","aggregator":"avg"},{"query":"sum:kubernetes.memory.usage{$kube_namespace,$kube_cluster_name,$env,$scope} by {pod_name,kube_cluster_name}","data_source":"metrics","name":"query1","aggregator":"avg"}]}},"xaxis":{"include_zero":true,"scale":"linear","min":"auto","max":"auto"},"yaxis":{"min":"0","max":"200"},"color_by_groups":["kube_cluster_name"]},"layout":{"x":6,"y":19,"width":6,"height":4}}]},"layout":{"x":0,"y":79,"width":12,"height":24}}],"template_variables":[{"name":"scope","prefix":"*","available_values":[],"default":"*"},{"name":"env","prefix":"env","available_values":[],"default":"*"},{"name":"kube_cluster_name","prefix":"kube_cluster_name","available_values":[],"default":"*"},{"name":"kube_namespace","prefix":"kube_namespace","available_values":[],"default":"*"}],"layout_type":"ordered","is_read_only":false,"notify_list":[],"reflow_type":"fixed","id":"23r-z5n-9n7"}